# Touch Down Card Game - API ν†µμ‹  κ·κ²© λ¬Έμ„

## π“‹ κ°μ”

μ΄ λ¬Έμ„λ” Touch Down Card Gameμ ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ κ°„ Socket.IO ν†µμ‹  κ·κ²©μ„ μ •μν•©λ‹λ‹¤.

## π” μ—°κ²° μ •λ³΄

- **μ„λ²„ μ£Όμ†**: `http://localhost:3000`
- **ν†µμ‹  λ°©μ‹**: Socket.IO (WebSocket κΈ°λ°)
- **ν¬νΈ**: 3000 (κΈ°λ³Έκ°’)

## π“΅ μ΄λ²¤νΈ κ·κ²©

### 1. μ—°κ²° μ΄λ²¤νΈ

#### 1.1 ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ‹
**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ**

```javascript
// μ΄λ²¤νΈλ…: 'connecting'
// λ°μ΄ν„°: μ΄κΈ° μ—°κ²° μ •λ³΄
{
  nickname: string,        // κΈ°λ³Έ λ‹‰λ„¤μ„ (μ: "User_12345678")
  roomList: Array<Room>    // ν„μ¬ λ€κΈ° μ¤‘μΈ λ°© λ©λ΅
}
```

**Room κ°μ²΄ κµ¬μ΅°:**
```javascript
{
  id: string,              // λ°© κ³ μ  ID
  name: string,            // λ°© μ΄λ¦„
  users: Array<User>,      // λ°©μ— μ°Έμ—¬ μ¤‘μΈ μ‚¬μ©μ λ©λ΅
  status: string,          // λ°© μƒνƒ ('waiting', 'playing', 'finished')
  maxUserCnt: number,      // μµλ€ μΈμ›μ
  createdAt: string        // λ°© μƒμ„± μ‹κ°„ (ISO 8601)
}
```

**User κ°μ²΄ κµ¬μ΅°:**
```javascript
{
  id: string,              // μ‚¬μ©μ μ†μΌ“ ID
  name: string,            // μ‚¬μ©μ λ‹‰λ„¤μ„
  readyStatus: string,     // μ¤€λΉ„ μƒνƒ ('waiting', 'ready')
  score: number,           // μ μ
  order: number,           // μμ„
  manager: boolean,        // λ°©μ¥ μ—¬λ¶€
  cardPack: Array<Card>   // λ³΄μ  μΉ΄λ“ (κ²μ„ μ¤‘)
}
```

### 2. μ‚¬μ©μ κ΄€λ¦¬ μ΄λ²¤νΈ

#### 2.1 λ‹‰λ„¤μ„ λ³€κ²½
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'change name'
// λ°μ΄ν„°: μƒλ΅μ΄ λ‹‰λ„¤μ„
"μƒλ΅μ΄λ‹‰λ„¤μ„"
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (μ„±κ³µ)**
```javascript
// μ΄λ²¤νΈλ…: 'name change successful'
// λ°μ΄ν„°: λ³€κ²½λ λ‹‰λ„¤μ„
"μƒλ΅μ΄λ‹‰λ„¤μ„"
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (μ‹¤ν¨)**
```javascript
// μ΄λ²¤νΈλ…: 'name change error'
// λ°μ΄ν„°: μ—λ¬ λ©”μ‹μ§€
"λ‹‰λ„¤μ„μ„ μ…λ ¥ν•΄μ£Όμ„Έμ”."
```

### 3. μ±„ν… μ΄λ²¤νΈ

#### 3.1 μ±„ν… λ©”μ‹μ§€ μ „μ†΅
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'chat message'
// λ°μ΄ν„°: λ©”μ‹μ§€ λ‚΄μ©
"μ•λ…•ν•μ„Έμ”!"
```

**μ„λ²„ β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈ**
```javascript
// μ΄λ²¤νΈλ…: 'chat message'
// λ°μ΄ν„°: μ±„ν… μ •λ³΄
{
  user: string,            // λ°μ‹ μ λ‹‰λ„¤μ„
  message: string,         // λ©”μ‹μ§€ λ‚΄μ©
  timestamp: string        // μ „μ†΅ μ‹κ°„ (ISO 8601)
}
```

### 4. λ°© κ΄€λ¦¬ μ΄λ²¤νΈ

#### 4.1 λ°© μƒμ„±
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'createRoom'
// λ°μ΄ν„°: λ°© μ΄λ¦„, μµλ€ μΈμ›μ
"λ°©μ΄λ¦„", 4
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (μ„±κ³µ)**
```javascript
// μ΄λ²¤νΈλ…: 'roomCreated'
// λ°μ΄ν„°: μƒμ„±λ λ°© μ •λ³΄
{
  id: "room-uuid",
  name: "λ°©μ΄λ¦„",
  users: [User],
  status: "waiting",
  maxUserCnt: 4,
  upCardList: [],
  turn: 0,
  createdAt: "2024-01-01T00:00:00.000Z"
}
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (μ‹¤ν¨)**
```javascript
// μ΄λ²¤νΈλ…: 'createRoomError'
// λ°μ΄ν„°: μ—λ¬ λ©”μ‹μ§€
"μ΄λ―Έ κ°™μ€ μ΄λ¦„μ λ°©μ΄ μ΅΄μ¬ν•©λ‹λ‹¤."
```

#### 4.2 λ°© λ©λ΅ μ΅°ν
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'roomList'
// λ°μ΄ν„°: μ—†μ
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ**
```javascript
// μ΄λ²¤νΈλ…: 'roomList'
// λ°μ΄ν„°: λ€κΈ° μ¤‘μΈ λ°© λ©λ΅
[
  {
    id: "room-uuid-1",
    name: "λ°©μ΄λ¦„1",
    users: [User, User],
    status: "waiting",
    maxUserCnt: 4,
    createdAt: "2024-01-01T00:00:00.000Z"
  }
]
```

#### 4.3 λ°© μ…μ¥
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'joinRoom'
// λ°μ΄ν„°: λ°© ID
"room-uuid"
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (μ„±κ³µ)**
```javascript
// μ΄λ²¤νΈλ…: 'successJoinRoom'
// λ°μ΄ν„°: λ°© μ •λ³΄
{
  id: "room-uuid",
  name: "λ°©μ΄λ¦„",
  users: [User, User, User],
  status: "waiting",
  maxUserCnt: 4,
  upCardList: [],
  turn: 0,
  createdAt: "2024-01-01T00:00:00.000Z"
}
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (μ‹¤ν¨)**
```javascript
// μ΄λ²¤νΈλ…: 'faildJoinRoom'
// λ°μ΄ν„°: μ—λ¬ λ©”μ‹μ§€
"λ°© μΈμ›μ΄ κ°€λ“ μ°Όμµλ‹λ‹¤."
```

**μ„λ²„ β†’ κ°™μ€ λ°©μ λ‹¤λ¥Έ μ‚¬μ©μλ“¤**
```javascript
// μ΄λ²¤νΈλ…: 'joinUser'
// λ°μ΄ν„°: μ—…λ°μ΄νΈλ μ‚¬μ©μ μ •λ³΄
{
  users: [User, User, User],
  maxUserCnt: 4
}
```

#### 4.4 λ°© λ‚κ°€κΈ°
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'leaveRoom'
// λ°μ΄ν„°: λ°© ID
"room-uuid"
```

**μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ**
```javascript
// μ΄λ²¤νΈλ…: 'leaveRoomResult'
// λ°μ΄ν„°: κ²°κ³Ό μ •λ³΄
{
  status: 200,                    // 200: μ„±κ³µ, 400: μ‹¤ν¨
  message: "successLeaveRoom"     // κ²°κ³Ό λ©”μ‹μ§€
}
```

**μ„λ²„ β†’ κ°™μ€ λ°©μ λ‹¤λ¥Έ μ‚¬μ©μλ“¤**
```javascript
// μ΄λ²¤νΈλ…: 'leaveUser'
// λ°μ΄ν„°: μ—…λ°μ΄νΈλ μ‚¬μ©μ μ •λ³΄
{
  users: [User, User],            // λ‚¨μ€ μ‚¬μ©μλ“¤
  newManager: User | null          // μƒλ΅μ΄ λ°©μ¥ (λ°©μ¥μ΄ λ‚κ°„ κ²½μ°)
}
```

### 5. κ²μ„ μ΄λ²¤νΈ

#### 5.1 μ¤€λΉ„ μƒνƒ λ³€κ²½
**ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„**
```javascript
// μ΄λ²¤νΈλ…: 'ready'
// λ°μ΄ν„°: μ—†μ
```

**μ„λ²„ β†’ κ°™μ€ λ°©μ λ¨λ“  μ‚¬μ©μ**
```javascript
// μ΄λ²¤νΈλ…: 'updateReadyStatus'
// λ°μ΄ν„°: μ—…λ°μ΄νΈλ μ‚¬μ©μ λ©λ΅
[User, User, User]
```

**μ„λ²„ β†’ κ°™μ€ λ°©μ λ¨λ“  μ‚¬μ©μ (λ¨λ“  μ‚¬μ©μ μ¤€λΉ„ μ™„λ£)**
```javascript
// μ΄λ²¤νΈλ…: 'allReady'
// λ°μ΄ν„°: μ¤€λΉ„λ μ‚¬μ©μ λ©λ΅
[User, User, User]
```

**μ„λ²„ β†’ κ°™μ€ λ°©μ λ¨λ“  μ‚¬μ©μ (κ²μ„ μ‹μ‘)**
```javascript
// μ΄λ²¤νΈλ…: 'gameStart'
// λ°μ΄ν„°: κ²μ„ μ‹μ‘ μ •λ³΄
{
  message: "κ²μ„μ΄ μ‹μ‘λ©λ‹λ‹¤!",
  users: [User, User, User]
}
```

## π”„ μ΄λ²¤νΈ νλ¦„

### 1. μ‚¬μ©μ μ—°κ²° λ° λ°© μƒμ„± νλ¦„

```
1. ν΄λΌμ΄μ–ΈνΈ μ—°κ²°
   β†“
2. μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: 'connecting' (μ΄κΈ° λ°μ΄ν„°)
   β†“
3. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: 'change name' (λ‹‰λ„¤μ„ λ³€κ²½)
   β†“
4. μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: 'name change successful'
   β†“
5. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: 'createRoom' (λ°© μƒμ„±)
   β†“
6. μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: 'roomCreated' (λ°© μƒμ„± μ„±κ³µ)
   β†“
7. μ„λ²„ β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈ: 'roomList' (λ°© λ©λ΅ μ—…λ°μ΄νΈ)
```

### 2. λ°© μ…μ¥ λ° κ²μ„ μ‹μ‘ νλ¦„

```
1. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: 'joinRoom' (λ°© μ…μ¥)
   β†“
2. μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: 'successJoinRoom' (μ…μ¥ μ„±κ³µ)
   β†“
3. μ„λ²„ β†’ κ°™μ€ λ°© μ‚¬μ©μλ“¤: 'joinUser' (μ‚¬μ©μ μ…μ¥ μ•λ¦Ό)
   β†“
4. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: 'ready' (μ¤€λΉ„)
   β†“
5. μ„λ²„ β†’ κ°™μ€ λ°© μ‚¬μ©μλ“¤: 'updateReadyStatus' (μ¤€λΉ„ μƒνƒ μ—…λ°μ΄νΈ)
   β†“
6. λ¨λ“  μ‚¬μ©μ μ¤€λΉ„ μ™„λ£ μ‹:
   μ„λ²„ β†’ κ°™μ€ λ°© μ‚¬μ©μλ“¤: 'allReady'
   β†“
7. 3μ΄ ν›„:
   μ„λ²„ β†’ κ°™μ€ λ°© μ‚¬μ©μλ“¤: 'gameStart' (κ²μ„ μ‹μ‘)
```

### 3. λ°© λ‚κ°€κΈ° νλ¦„

```
1. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: 'leaveRoom' (λ°© λ‚κ°€κΈ°)
   β†“
2. μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: 'leaveRoomResult' (λ‚κ°€κΈ° κ²°κ³Ό)
   β†“
3. λ°©μ΄ μ‚­μ λμ§€ μ•μ€ κ²½μ°:
   μ„λ²„ β†’ κ°™μ€ λ°© μ‚¬μ©μλ“¤: 'leaveUser' (μ‚¬μ©μ λ‚κ°€κΈ° μ•λ¦Ό)
   β†“
4. μ„λ²„ β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈ: 'roomList' (λ°© λ©λ΅ μ—…λ°μ΄νΈ)
```

## β οΈ μ—λ¬ μ²λ¦¬

### μ—λ¬ μ½”λ“ λ° λ©”μ‹μ§€

| μ—λ¬ μƒν™© | μ—λ¬ λ©”μ‹μ§€ |
|-----------|-------------|
| ν•„μ μ…λ ¥κ°’ λ„λ½ | "ν•„μ μ…λ ¥κ°’μ΄ λ„λ½λμ—μµλ‹λ‹¤." |
| λ°© μ΄λ¦„ μ¤‘λ³µ | "μ΄λ―Έ κ°™μ€ μ΄λ¦„μ λ°©μ΄ μ΅΄μ¬ν•©λ‹λ‹¤." |
| λ°©μ΄ μ΅΄μ¬ν•μ§€ μ•μ | "μ΅΄μ¬ν•μ§€ μ•λ” λ°©μ…λ‹λ‹¤." |
| λ°© μΈμ› μ΄κ³Ό | "λ°© μΈμ›μ΄ κ°€λ“ μ°Όμµλ‹λ‹¤." |
| λ°© μƒνƒ μ¤λ¥ | "μ΄ λ°©μ€ μ…μ¥ν•  μ μ—†λ” μƒνƒμ…λ‹λ‹¤." |
| μ¤‘λ³µ μ°Έμ—¬ | "μ΄λ―Έ λ‹¤λ¥Έ λ°©μ— μ°Έμ—¬ μ¤‘μ…λ‹λ‹¤." |
| μ‚¬μ©μ μ •λ³΄ μ—†μ | "μ‚¬μ©μ μ •λ³΄λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤." |
| μµλ€ μΈμ›μ μ¤λ¥ | "μµλ€ μΈμ›μλ” 2λ… μ΄μƒ 8λ… μ΄ν•μ—¬μ•Ό ν•©λ‹λ‹¤." |

## π“ μ‚¬μ© μμ‹

### JavaScript ν΄λΌμ΄μ–ΈνΈ μμ‹

```javascript
// Socket.IO ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™”
const socket = io('http://localhost:3000');

// μ—°κ²° μ‹ μ΄κΈ° λ°μ΄ν„° μμ‹ 
socket.on('connecting', (data) => {
  console.log('λ‹‰λ„¤μ„:', data.nickname);
  console.log('λ°© λ©λ΅:', data.roomList);
});

// λ‹‰λ„¤μ„ λ³€κ²½
socket.emit('change name', 'μƒλ΅μ΄λ‹‰λ„¤μ„');

// λ°© μƒμ„±
socket.emit('createRoom', 'ν…μ¤νΈλ°©', 4);

// λ°© μ…μ¥
socket.emit('joinRoom', 'room-uuid');

// μ¤€λΉ„
socket.emit('ready');

// μ±„ν… λ©”μ‹μ§€ μ „μ†΅
socket.emit('chat message', 'μ•λ…•ν•μ„Έμ”!');

// λ°© λ‚κ°€κΈ°
socket.emit('leaveRoom', 'room-uuid');
```

## π”§ κ°λ°μ κ°€μ΄λ“

### μ„λ²„ μ„¤μ •
```javascript
// μ„λ²„ μ‹μ‘
const PORT = process.env.PORT || 3000;
server.listen(PORT, () => {
  console.log(`μ„λ²„κ°€ ${PORT}λ² ν¬νΈμ—μ„ μ‹μ‘λμ—μµλ‹λ‹¤.`);
});
```

### ν΄λΌμ΄μ–ΈνΈ μ„¤μ •
```javascript
// Socket.IO ν΄λΌμ΄μ–ΈνΈ λΌμ΄λΈλ¬λ¦¬ ν¬ν•¨
<script src="/socket.io/socket.io.js"></script>

// μ—°κ²°
const socket = io();
```

## π“ μ„±λ¥ κ³ λ ¤μ‚¬ν•­

- **λ™μ‹ μ—°κ²° μ**: μµλ€ 1000λ… (κΈ°λ³Έ μ„¤μ •)
- **λ°©λ‹Ή μµλ€ μΈμ›**: 8λ…
- **λ©”μ‹μ§€ μ „μ†΅ μ£ΌκΈ°**: μ‹¤μ‹κ°„ (WebSocket)
- **μ¬μ—°κ²°**: μλ™ μ¬μ—°κ²° μ§€μ›

## π›΅οΈ λ³΄μ• κ³ λ ¤μ‚¬ν•­

- **μ…λ ¥κ°’ κ²€μ¦**: λ¨λ“  μ…λ ¥κ°’μ— λ€ν• μ ν¨μ„± κ²€μ‚¬
- **μ—λ¬ μ²λ¦¬**: μ μ ν• μ—λ¬ λ©”μ‹μ§€ λ° μƒνƒ μ½”λ“
- **λ©”λ¨λ¦¬ κ΄€λ¦¬**: μ‚¬μ©μ μ—°κ²° ν•΄μ  μ‹ μ μ ν• μ •λ¦¬
- **λ™μ‹μ„± μ²λ¦¬**: Race condition λ°©μ§€

μ΄ λ¬Έμ„λ” Touch Down Card Gameμ API ν†µμ‹  κ·κ²©μ„ μ •μν•λ©°, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ μΌκ΄€λ ν†µμ‹ μ„ λ³΄μ¥ν•©λ‹λ‹¤.
